<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href='https://unpkg.com/boxicons@2.0.9/css/boxicons.min.css' rel='stylesheet'>
  <link rel="stylesheet" href="page1style.css">
  <title>Pulse-Watt - Stationary Bike Data</title>
</head>

<body>
  <!-- SIDEBAR -->
  <section id="sidebar">
    <a href="#" class="brand"><i class='bx bxs-smile icon'></i> Pulse-Watt</a>
    <ul class="side-menu">
      <li><a href="index.html"><i class='bx bxs-dashboard icon'></i> Dashboard</a></li>
      <li class="divider" data-text="main">Main</li>
      <li>
        <a href="#"><i class='bx bxs-inbox icon'></i> Analytics <i class='bx bx-chevron-right icon-right'></i></a>
        <ul class="side-dropdown">
          <li><a href="#">Real Time Alerts</a></li>
          <li><a href="#">Equipment Status</a></li>
          <!-- <li><a href="#">Total Energy Generated</a></li> -->
        </ul>
      </li>
      <li><a href="members.html"><i class='bx bxs-widget icon'></i> Members</a></li>
      <li><a href="rewards.html"><i class='bx bxs-widget icon'></i> Rewards</a></li>
			<li><a href="page1.html" class="active"><i class='bx bxs-widget icon'></i> Total Energy Generated</a></li>

    </ul>
  </section>
  <!-- SIDEBAR -->

  <!-- NAVBAR -->
  <section id="content">
    <!-- NAVBAR -->
    <nav>
      <i class='bx bx-menu toggle-sidebar'></i>
      <form action="#"></form>
      <span class="divider"></span>
      <div class="profile">
        <img
          src="https://images.unsplash.com/photo-1517841905240-472988babdf9?ixid=MnwxMjA3fDB8MHxzZWFyY2h8NHx8cGVvcGxlfGVufDB8fDB8fA%3D%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60"
          alt="">
        <ul class="profile-link">
          <li><a href="#"><i class='bx bxs-user-circle icon'></i> Profile</a></li>
          <li><a href="#"><i class='bx bxs-cog'></i> Settings</a></li>
          <li><a href="login.html"><i class='bx bxs-log-out-circle'></i> Logout</a></li>
        </ul>
      </div>
    </nav>
    <!-- NAVBAR -->

    <!-- MAIN -->
    <main>
      <ul class="breadcrumbs">
        <li><a href="index.html">Home</a></li>
        <li class="divider">/</li>
        <li><a href="#" class="active">Dashboard</a></li>
        <li class="divider">/</li>
        <li><a href="#" class="active">Stationary Bike</a></li>
      </ul>
      <div class="info-data">
        <a href="#" class="card-link">
          <div class="card">
            <div class="head">
              <div>
                <h2>RPM</h2>
                <p>RPM generated by Stationary Bike</p>
              </div>
              <i class='bx bx-trending-up icon'></i>
            </div>
            <div class="chart-container">
              <div id="chart1"></div>
            </div>
          </div>
        </a>
        <a href="#" class="card-link">
          <div class="card">
            <div class="head">
              <div>
                <h2>Temperature</h2>
                <p>Temperature (Real Time Heat Monitoring of Product)</p>
              </div>
              <i class='bx bx-trending-up icon'></i>
            </div>
            <div class="chart-container">
              <div id="chart3"></div>
            </div>
          </div>
        </a>
        <a href="#" class="card-link">
          <div class="card">
            <div class="head">
              <div>
                <h2>Current (A)</h2>
                <p>Current generated by Stationary Bike</p>
              </div>
              <i class='bx bx-trending-up icon'></i>
            </div>
            <div class="chart-container">
              <div id="chart5"></div>
            </div>
          </div>
        </a>
        <a href="#" class="card-link">
          <div class="card">
            <div class="head">
              <div>
                <h2>Voltage (V)</h2>
                <p>Voltage generated by Stationary Bike</p>
              </div>
              <i class='bx bx-trending-up icon'></i>
            </div>
            <div class="chart-container">
              <div id="chart4"></div>
            </div>
          </div>
        </a>
        <a href="#" class="card-link">
          <div class="card">
            <div class="head">
              <div>
                <h2>Total Energy</h2>
                <p>Energy Generated (Wh)</p>
              </div>
              <i class='bx bx-trending-up icon'></i>
            </div>
            <div class="chart-container">
              <div id="chart6"></div>
            </div>
          </div>
        </a>
      </div>


      <table>
        <thead>
          <tr>
            <th>S.no</th>
            <th>Equipment ID</th>
            <th>RPM</th>
            <th>Voltage (in V)</th>
            <th>Timestamp</th>
            <th>Temperature (Â°C)</th>
            <th>Current (in Amp)</th>
            <th>Total Energy</th> <!-- NEW COLUMN HERE -->
          </tr>
        </thead>
        <tbody id="data-body">
          <!-- Data will be dynamically inserted here -->
        </tbody>
      </table>
    </main>
    <!-- MAIN -->
  </section>
  <!-- NAVBAR -->

  <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
  <!-- Your existing UI logic for toggles, chart, etc. -->
  <script src="script.js"></script>

  <!-- Data polling + row appending script -->
  <script>
    // Store timestamps to prevent duplicate rows
    const seenTimestamps = new Set();

    

    // Fetch data every 3 seconds without clearing the table
    async function fetchData() {
      try {
        const response = await fetch('https://pulsewatt-backend.onrender.com/data');
        const data = await response.json();

        if (data.error) {
          console.error("Error:", data.error);
          return;
        }

        appendRows(data); // Append new data without clearing the table
      } catch (error) {
        console.error('Error fetching data:', error);
      }
    }

    // Poll server every 3 seconds
    setInterval(fetchData, 3000);
  </script>

</body>

</html>
